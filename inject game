game = {}
function game:HttpGet(url)
    -- cmd指令
    local cmd = "curl -s " .. url

    local handle = io.popen(cmd)
    local response = handle:read("*a")
    handle:close()

    return response
end

local form = createForm(true)
form.Caption = "注入遊戲"
form.Width = 300
form.Height = 150
form.Position = poScreenCenter
form.FormStyle = fsStayOnTop
form.BorderStyle = bsNone 

function InjectGame()
    local gameName = "MiniGameApp.exe"
    local processID = getProcessIDFromProcessName(gameName)
    if processID ~= nil then
        showMessage("已注入遊戲")
        load(game:HttpGet("https://raw.githubusercontent.com/uwu1145/z-ware/main/create%20function"))()
        load(game:HttpGet("https://raw.githubusercontent.com/uwu1145/z-ware/main/z-ware"))()
    else
        showMessage("未檢測到遊戲")
    end
end

local injectButton = createButton(form)
injectButton.Caption = "注入遊戲"
injectButton.Width = 240
injectButton.Height = 100
injectButton.Left = (form.Width - injectButton.Width) / 2
injectButton.Top = (form.Height - injectButton.Height) / 2
injectButton.OnClick = function()
    form.hide()
    InjectGame()
end

form.show()
